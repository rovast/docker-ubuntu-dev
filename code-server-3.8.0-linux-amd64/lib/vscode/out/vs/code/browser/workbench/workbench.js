/*!--------------------------------------------------------
 * Copyright (C) Microsoft Corporation. All rights reserved.
 *--------------------------------------------------------*/
(function(){var e=["vs/server/node/util","require","exports","vs/base/common/uriIpc","vs/code/browser/workbench/workbench","vs/workbench/workbench.web.api","vs/base/common/uri","vs/base/common/event","vs/base/common/uuid","vs/base/common/cancellation","vs/base/common/buffer","vs/base/common/lifecycle","vs/base/parts/request/browser/request","vs/platform/windows/common/windows","vs/base/common/resources","vs/base/browser/browser","vs/nls!vs/code/browser/workbench/workbench","vs/base/common/network","vs/platform/product/common/product"],o=function(o){for(var t=[],r=0,s=o.length;r<s;r++)t[r]=e[o[r]];return t};define(e[0],o([1,2,3]),(function(e,o,t){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.encodePath=o.getUriTransformer=void 0;o.getUriTransformer=e=>new t.URITransformer(e);o.encodePath=e=>e.split("/").map(e=>encodeURIComponent(e)).join("/")})),define(e[4],o([1,2,5,6,7,8,9,10,11,12,13,14,15,16,17,18,0]),(function(e,o,t,r,s,i,n,a,c,l,d,h,u,w,p,v,m){"use strict";function f(e,o){let t=void 0
;if(o){let e=0;o.forEach((o,r)=>{t||(t="");const s=0==e++?"":"&";t+=`${s}${r}=${encodeURIComponent(o)}`})}return r.URI.parse(window.location.href).with({path:e,query:t})}Object.defineProperty(o,"__esModule",{value:!0});class E{constructor(){let e;const o=document.getElementById("vscode-workbench-auth-session"),t=o?o.getAttribute("data-settings"):void 0;if(t)try{e=JSON.parse(t)}catch(e){}e&&(this.setPassword(`${v.default.urlProtocol}.login`,"account",JSON.stringify(e)),this.authService=`${v.default.urlProtocol}-${e.providerId}.login`,this.setPassword(this.authService,"account",JSON.stringify(e.scopes.map(o=>({id:e.id,scopes:o,accessToken:e.accessToken})))))}get credentials(){if(!this._credentials){try{const e=window.localStorage.getItem(E.CREDENTIALS_OPENED_KEY);e&&(this._credentials=JSON.parse(e))}catch(e){}Array.isArray(this._credentials)||(this._credentials=[])}return this._credentials}save(){window.localStorage.setItem(E.CREDENTIALS_OPENED_KEY,JSON.stringify(this.credentials))}async getPassword(e,o){
return this.doGetPassword(e,o)}async doGetPassword(e,o){for(const t of this.credentials)if(t.service===e&&("string"!=typeof o||o===t.account))return t.password;return null}async setPassword(e,o,t){this.doDeletePassword(e,o),this.credentials.push({service:e,account:o,password:t}),this.save();try{if(t&&e===this.authService){const o=JSON.parse(t);Array.isArray(o)&&0===o.length&&await this.logout(e)}}catch(e){console.log(e)}}async deletePassword(e,o){const t=await this.doDeletePassword(e,o);if(t&&e===this.authService)try{await this.logout(e)}catch(e){console.log(e)}return t}async doDeletePassword(e,o){let t=!1;return this._credentials=this.credentials.filter(r=>r.service!==e||r.account!==o||(t=!0,!1)),t&&this.save(),t}async findPassword(e){return this.doGetPassword(e)}async findCredentials(e){return this.credentials.filter(o=>o.service===e).map(({account:e,password:o})=>({account:e,password:o}))}async logout(e){const o=new Map;o.set("logout",String(!0)),o.set("service",e),await l.request({
url:f("/auth/logout",o).toString(!0)},n.CancellationToken.None)}}E.CREDENTIALS_OPENED_KEY="credentials.provider";class U extends c.Disposable{constructor(){super(...arguments),this._onCallback=this._register(new s.Emitter),this.onCallback=this._onCallback.event}create(e){const o=new Map,t=i.generateUuid();o.set(U.QUERY_KEYS.REQUEST_ID,t);const{scheme:r,authority:s,path:n,query:a,fragment:c}=e||{scheme:void 0,authority:void 0,path:void 0,query:void 0,fragment:void 0};return r&&o.set(U.QUERY_KEYS.SCHEME,r),s&&o.set(U.QUERY_KEYS.AUTHORITY,s),n&&o.set(U.QUERY_KEYS.PATH,n),a&&o.set(U.QUERY_KEYS.QUERY,a),c&&o.set(U.QUERY_KEYS.FRAGMENT,c),this.periodicFetchCallback(t,Date.now()),f("/callback",o)}async periodicFetchCallback(e,o){const t=new Map;t.set(U.QUERY_KEYS.REQUEST_ID,e);const s=await l.request({url:f("/fetch-callback",t).toString(!0)},n.CancellationToken.None),i=await a.streamToBuffer(s.stream);if(i.byteLength>0)try{this._onCallback.fire(r.URI.revive(JSON.parse(i.toString())))}catch(e){console.error(e)
}else Date.now()-o<U.FETCH_TIMEOUT&&setTimeout(()=>this.periodicFetchCallback(e,o),U.FETCH_INTERVAL)}}U.FETCH_INTERVAL=500,U.FETCH_TIMEOUT=3e5,U.QUERY_KEYS={REQUEST_ID:"vscode-requestId",SCHEME:"vscode-scheme",AUTHORITY:"vscode-authority",PATH:"vscode-path",QUERY:"vscode-query",FRAGMENT:"vscode-fragment"};class y{constructor(e,o){this.workspace=e,this.payload=o}async open(e,o){if((null==o?void 0:o.reuse)&&!o.payload&&this.isSame(this.workspace,e))return;const t=this.createTargetUrl(e,o);t&&((null==o?void 0:o.reuse)?window.location.href=t:u.isStandalone?window.open(t,"_blank","toolbar=no"):window.open(t))}createTargetUrl(e,o){let t=void 0;if(e){if(d.isFolderToOpen(e)){const o=e.folderUri.scheme===p.Schemas.vscodeRemote?m.encodePath(e.folderUri.path):encodeURIComponent(e.folderUri.toString());t=`${document.location.origin}${document.location.pathname}?${y.QUERY_PARAM_FOLDER}=${o}`}else if(d.isWorkspaceToOpen(e)){
const o=e.workspaceUri.scheme===p.Schemas.vscodeRemote?m.encodePath(e.workspaceUri.path):encodeURIComponent(e.workspaceUri.toString());t=`${document.location.origin}${document.location.pathname}?${y.QUERY_PARAM_WORKSPACE}=${o}`}}else t=`${document.location.origin}${document.location.pathname}?${y.QUERY_PARAM_EMPTY_WINDOW}=true`;return(null==o?void 0:o.payload)&&(t+=`&${y.QUERY_PARAM_PAYLOAD}=${encodeURIComponent(JSON.stringify(o.payload))}`),t}isSame(e,o){return e&&o?d.isFolderToOpen(e)&&d.isFolderToOpen(o)?h.isEqual(e.folderUri,o.folderUri):!(!d.isWorkspaceToOpen(e)||!d.isWorkspaceToOpen(o))&&h.isEqual(e.workspaceUri,o.workspaceUri):e===o}hasRemote(){if(this.workspace){if(d.isFolderToOpen(this.workspace))return this.workspace.folderUri.scheme===p.Schemas.vscodeRemote;if(d.isWorkspaceToOpen(this.workspace))return this.workspace.workspaceUri.scheme===p.Schemas.vscodeRemote}return!0}}y.QUERY_PARAM_EMPTY_WINDOW="ew",y.QUERY_PARAM_FOLDER="folder",y.QUERY_PARAM_WORKSPACE="workspace",y.QUERY_PARAM_PAYLOAD="payload"
;class g{constructor(e){this.onDidChange=s.Event.None;let o=void 0,t=void 0;if(e){let r=void 0;d.isFolderToOpen(e)?r=e.folderUri:d.isWorkspaceToOpen(e)&&(r=e.workspaceUri),"github"!==(null==r?void 0:r.scheme)&&"codespace"!==(null==r?void 0:r.scheme)||([o,t]=r.authority.split("+"))}t&&o?(this.label=w.localize(0,null,o,t),this.tooltip=w.localize(1,null,o,t)):(this.label=w.localize(2,null),this.tooltip=w.localize(3,null))}}!function(){var e;const o=document.getElementById("vscode-workbench-web-configuration"),s=o?o.getAttribute("data-settings"):void 0;if(!o||!s)throw new Error("Missing web configuration element");const i=Object.assign({webviewEndpoint:`${window.location.origin}${window.location.pathname.replace(/\/+$/,"")}/webview`},JSON.parse(s)),n=e=>e.replace(/^https?:\/\//,"");i.remoteAuthority&&(i.remoteAuthority=n(i.remoteAuthority)),i.workspaceUri&&i.workspaceUri.authority&&(i.workspaceUri.authority=n(i.workspaceUri.authority)),
i.folderUri&&i.folderUri.authority&&(i.folderUri.authority=n(i.folderUri.authority)),Array.isArray(i.staticExtensions)&&i.staticExtensions.forEach(e=>{e.extensionLocation=r.URI.revive(e.extensionLocation)});let a,c=(null===(e=i.workspaceProvider)||void 0===e?void 0:e.payload)||Object.create(null);a=i.folderUri?{folderUri:r.URI.revive(i.folderUri)}:i.workspaceUri?{workspaceUri:r.URI.revive(i.workspaceUri)}:void 0;const l=new y(a,c);let d=void 0;l.hasRemote()||(d=new g(a));const h=i.settingsSyncOptions?{enabled:i.settingsSyncOptions.enabled,enablementHandler:e=>{let o=`settingsSync=${e?"true":"false"}`;new URL(document.location.href).searchParams.forEach((e,t)=>{"settingsSync"!==t&&(o+=`&${t}=${e}`)}),window.location.href=`${window.location.origin}?${o}`}}:void 0;t.create(document.body,Object.assign(Object.assign({},i),{settingsSyncOptions:h,windowIndicator:d,productQualityChangeHandler:e=>{let o=`quality=${e}`;new URL(document.location.href).searchParams.forEach((e,t)=>{"quality"!==t&&(o+=`&${t}=${e}`)}),
window.location.href=`${window.location.origin}?${o}`},workspaceProvider:l,urlCallbackProvider:new U,credentialsProvider:new E}))}()}))}).call(this);
//# sourceMappingURL=workbench.js.map
